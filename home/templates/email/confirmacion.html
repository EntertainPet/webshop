<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ConfirmaciÃ³n de Pedido - EntertainPet</title>
</head>
<body style="font-family: 'Roboto', sans-serif, Arial; background-color: #fff7f3; margin: 0; padding: 0;">

    <table width="100%" cellpadding="0" cellspacing="0" border="0" style="background-color: #fff7f3;">
        <tr>
            <td align="center" style="padding: 20px 0;">
                <table width="600" cellpadding="0" cellspacing="0" border="0" style="background-color: #ffffff; border-radius: 10px; border: 1px solid #ffdfd3; box-shadow: 0 4px 10px rgba(0,0,0,0.05); max-width: 600px; width: 100%;">
                    
                    <tr>
                        <td style="background-color: #ffdfd3; padding: 18px 0 22px 0; text-align: center; border-radius: 10px 10px 0 0;">
                            <div style="margin-top:10px;">
                                <span style="display:block; color: #6b4c3b; font-size:28px; font-weight:800; letter-spacing: 1px;">EntertainPet</span>
                                <small style="display:block; color:#6b4c3b; opacity:0.9; margin-top:4px; font-size:13px;">Tu tienda de confianza para mascotas</small>
                            </div>
                        </td>
                    </tr>

                    <tr>
                        <td style="padding: 30px 40px 20px 40px;">
                            <div style="text-align:center;">
                                <img src="cid:logo_cid" alt="EntertainPet Logo" style="height:200px; width:auto; display:block; margin: 0 auto;">
                            </div>
                            <h1 style="color: #6b4c3b; margin-top: 0; font-size: 24px; font-weight: 700;">Â¡Pedido Confirmado!</h1>
                            <p style="font-size: 15px; line-height: 1.6; color: #555;">
                                Â¡Muchas gracias por tu compra, 
                                {% if cliente %}<strong style="color: #6b4c3b;">{{ cliente.username }}</strong>{% else %}cliente{% endif %}!
                                <br>Tu pedido ha sido procesado con Ã©xito y estamos preparando el envÃ­o.
                            </p>
                            
                            <p style="font-size: 14px; line-height: 1.5; color: #555; padding-top: 15px; border-top: 1px solid #ffdfd3;">
                                <strong>NÃºmero de pedido:</strong> 
                                <span style="color: #ff6f61; font-weight: bold; display: inline-block; margin-left: 5px;">#{{ pedido.stripe_checkout_id }}</span><br>
                                <strong>Estado:</strong> 
                                <span style="color: #28a745; font-weight: bold; display: inline-block; margin-left: 5px;">{{ pedido.status }}</span>
                            </p>
                        </td>
                    </tr>

					<tr>
						<td align="center" style="padding: 0 40px 30px 40px;">
											<a href="{% url 'home:seguimiento' pedido.id %}" target="_blank" style="display: inline-block; padding: 15px 30px; background-color: #ff6f61; color: #ffffff; text-decoration: none; border-radius: 5px; font-weight: 700; font-size: 17px; box-shadow: 0 4px 6px rgba(0, 0, 0, 0.1);">
												ðŸšš Ver seguimiento de pedido
											</a>
										</td>
					</tr>
					
					{% if cliente and cliente.direccion %}
					<tr>
						<td style="padding: 0 40px 25px 40px;">
							<h3 style="color: #6b4c3b; font-size: 16px; border-bottom: 2px solid #6b4c3b; padding-bottom: 5px; margin-top: 0;">ðŸ“¦ DirecciÃ³n de Entrega</h3>
							<p style="font-size: 13px; color: #555; line-height: 1.6; background-color: #fff7f3; padding: 15px; border-radius: 4px; border: 1px solid #ffdfd3;">
								<strong>{{ cliente.first_name }} {{ cliente.last_name }}</strong><br>
								{{ cliente.direccion }}, {{ cliente.ciudad }}, {{ cliente.codigo_postal }}<br>
								TelÃ©fono: +34 {{ cliente.telefono }}
							</p>
						</td>
					</tr>
					{% endif %}
					<tr>
						<td style="padding: 0 40px;">
							<h3 style="color: #6b4c3b; font-size: 16px; border-bottom: 2px solid #6b4c3b; padding-bottom: 5px; margin-top: 0;">ðŸ›’ Resumen de la Compra</h3>

							<table width="100%" cellpadding="0" cellspacing="0" style="border: 1px solid #ffdfd3; margin-bottom: 20px; border-radius: 8px;">
								
								<tr style="background-color: #ffdfd3;">
									<td colspan="2" style="padding: 12px; color: #6b4c3b; font-weight: 700; font-size: 13px; border-bottom: 1px solid #ffdfd3;">Producto</td>
									<td style="padding: 12px; color: #6b4c3b; font-weight: 700; text-align: right; font-size: 13px; border-bottom: 1px solid #ffdfd3;">Total</td>
								</tr>

								{% for item in items_con_subtotal %}
								<tr>
									<td width="70" style="padding: 15px 10px 15px 15px; border-bottom: 1px solid #ffdfd3; vertical-align: middle;">
										{% if item.imagen_url %}
											<img src="{{ item.imagen_url }}" alt="{{ item.producto.nombre }}" style="width: 60px; height: 60px; object-fit: cover; display: block; border-radius: 8px; border: 1px solid #ffe5d9;">
										{% else %}
											<div style="width:60px;height:60px;background:#fff7f3;border-radius:8px;border:1px solid #ffe5d9;"></div>
										{% endif %}
									</td>

									<td style="padding: 15px 10px; border-bottom: 1px solid #ffdfd3; vertical-align: middle;">
										<div style="font-size: 14px; color: #333; font-weight: bold;">
											{{ item.producto.nombre }}
										</div>
										<div style="font-size: 12px; color: #777; margin-top: 4px;">
											{{ item.cantidad }} unidad(es) x ${{ item.producto.precio_final }}
										</div>
									</td>

									<td style="padding: 15px 15px 15px 10px; border-bottom: 1px solid #ffdfd3; text-align: right; vertical-align: middle; font-size: 14px; font-weight: 500;">
										${{ item.subtotal }}
									</td>
								</tr>
								{% endfor %}
								<tr>
									<td colspan="3" style="padding: 20px 15px; background-color: #ffe5d9; text-align: right; border-radius: 0 0 8px 8px;">
										<p style="margin: 0; font-size: 18px; font-weight: bold; color: #6b4c3b;">TOTAL PAGADO: <span style="color: #ff6f61;">${{ pedido.cantidad }}</span></p>
									</td>
								</tr>
							</table>
						</td>
					</tr>
					
					<tr>
						<td style="background-color: #ffe5d9; padding: 15px; text-align: center; font-size: 12px; color: #6b4c3b; border-radius: 0 0 10px 10px;">
							<p style="margin: 0;">Si tienes alguna pregunta, contacta con nuestro equipo de soporte.</p>
							<p style="margin: 5px 0 0 0;">&copy; 2025 EntertainPet. Todos los derechos reservados.</p>
						</td>
					</tr>

				</table>
			</td>
		</tr>
	</table>
</body>
</html>