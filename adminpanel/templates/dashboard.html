{% extends "base_admin.html" %}
{% load static %}

{% block header %}Dashboard General{% endblock %}

{% block content %}
<div class="container mt-4">

    <p class="text-muted">Estadísticas del sistema.</p>

    <!-- =======================
         METRIC CARDS
    ===========================-->
    <div class="row mt-4">

        <div class="col-md-4">
            <div class="card shadow-sm p-3">
                <h5 class="text-success">Pedidos este mes</h5>
                <p class="display-6 fw-bold">{{ num_pedidos_mes }}</p>
            </div>
        </div>

        <div class="col-md-4">
            <div class="card shadow-sm p-3">
                <h5 class="text-warning">Pendientes de envío</h5>
                <p class="display-6 fw-bold">{{ pedidos_pendientes }}</p>
            </div>
        </div>

        <div class="col-md-4">
            <div class="card shadow-sm p-3">
                <h5 class="text-danger">Ingreso promedio</h5>
                <p class="display-6 fw-bold">{{ ingreso_promedio|floatformat:2 }}€</p>
            </div>
        </div>

    </div>

    <!-- =======================
         LISTAS RECIENTES
    ===========================-->
    <div class="row mt-5">

        <div class="col-md-6">
            <div class="card p-3 shadow-sm">
                <h5>Últimos pedidos</h5>
                <table class="table table-sm">
                    <thead>
                        <tr>
                            <th>ID</th>
                            <th>Cliente</th>
                            <th>Fecha</th>
                        </tr>
                    </thead>
                    <tbody>
                        {% for p in ultimos_pedidos %}
                        <tr>
                            <td>{{ p.id }}</td>
                            <td>{{ p.cliente_email }}</td>
                            <td>{{ p.fecha_creacion|date:"d/m/Y" }}</td>
                        </tr>
                        {% empty %}
                        <tr><td colspan="3">No hay pedidos recientes.</td></tr>
                        {% endfor %}
                    </tbody>
                </table>
            </div>
        </div>

        <div class="col-md-6">
            <div class="card p-3 shadow-sm">
                <h5>Últimos clientes</h5>
                <table class="table table-sm">
                    <thead>
                        <tr>
                            <th>Usuario</th>
                            <th>Email</th>
                            <th>Fecha</th>
                        </tr>
                    </thead>
                    <tbody>
                        {% for c in ultimos_clientes %}
                        <tr>
                            <td>{{ c.username }}</td>
                            <td>{{ c.email }}</td>
                            <td>{{ c.date_joined|date:"d/m/Y" }}</td>
                        </tr>
                        {% empty %}
                        <tr><td colspan="3">No hay clientes registrados.</td></tr>
                        {% endfor %}
                    </tbody>
                </table>
            </div>
        </div>

    </div>

</div>
{% endblock %}
